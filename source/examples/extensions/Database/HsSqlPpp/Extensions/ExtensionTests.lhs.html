<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >ExtensionTests</title
    ><link href="../../../../../../main.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><div class="header"
    ><a href="../../../../../../index.txt.html"
      >HsSqlPpp-0.3.0</a
      ></div
    ><br
     /><br
     /><br
     /><p
    >Gather together the examples from the extension modules and convert to regular test code</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode"><span class="Keyword">module</span> <span class="ConId">Database.HsSqlPpp.Extensions.ExtensionTests</span>
    <span class="Symbol">(</span><span class="VarId">extensionTests</span><span class="Symbol">)</span> <span class="Keyword">where</span>

<span class="Keyword">import</span> <span class="ConId">Test.HUnit</span>
<span class="Keyword">import</span> <span class="ConId">Test.Framework</span>
<span class="Keyword">import</span> <span class="ConId">Test.Framework.Providers.HUnit</span>
<span class="Keyword">import</span> <span class="ConId">Control.Monad</span>
<span class="Comment">--import Debug.Trace</span>

<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Annotation</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.PrettyPrinter</span>

<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.ExtensionsUtils</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.CreateVarSimple</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.CreateVar</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.TransitionConstraints</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.CreateAssertionTests</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.CardinalityRestrict</span>
<span class="Comment">--import Database.HsSqlPpp.Extensions.ChaosExtensions</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.Modules</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.GeneralInclusion</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.Denormalized6nfExamples</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Extensions.DenormSyntax</span>

<span class="Function">testData</span> <span class="Symbol">::</span> <span class="Symbol">[</span><span class="ConId">ExtensionTest</span><span class="Symbol">]</span>
<span class="Function">testData</span> <span class="Symbol">=</span> <span class="VarId">transitionConstraintExamples</span> <span class="Symbol">++</span>
           <span class="VarId">createAssertionExamples</span> <span class="Symbol">++</span>
           <span class="Comment">--chaosExtensionsExamples ++</span>
           <span class="VarId">generalInclusionsExamples</span> <span class="Symbol">++</span>
           <span class="VarId">denormalized6nfExamples</span> <span class="Symbol">++</span>
           <span class="Symbol">[</span><span class="VarId">createVarSimpleExample</span>
           <span class="Symbol">,</span><span class="VarId">createVarExample</span>
           <span class="Symbol">,</span><span class="VarId">cardinalityRestrictExample</span>
           <span class="Symbol">,</span><span class="VarId">modulesExample</span>
           <span class="Symbol">]</span>

<span class="Function">otherTests</span> <span class="Symbol">::</span> <span class="Symbol">[</span><span class="ConId">Test.Framework.Test</span><span class="Symbol">]</span>
<span class="Function">otherTests</span> <span class="Symbol">=</span> <span class="Symbol">[</span><span class="VarId">denormParseTests</span><span class="Symbol">]</span></pre></div></div></div><pre
    ><code
      >rough plan for extensions

immediate goal is to rewrite chaos2010 much more nicely using new
extensions

ddl 'triggers' -&gt; reject, transform, or supplement a ddl statement
addreadonlytriggers
addnotifytriggers
constraints
zeroonetuple
transitionconstraints
default not null
modules
'_mr' table definitions and initialization data / relation constants
multiple updates
out of order definitions (after missing catalog elements are done)
simplified catalog

chaos: leftovers already written,
       turn sequence progression
       action valid tables
       ai
       what else?
       revlar types
       check only updates are in action_ functions

idea for attributes:
select attribute('type','readonly');
create table readonly_table ...
</code
      ></pre
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode"><span class="Function">extensionTests</span> <span class="Symbol">::</span> <span class="ConId">Test.Framework.Test</span>
<span class="Function">extensionTests</span> <span class="Symbol">=</span> <span class="VarId">testGroup</span> <span class="String">&quot;extensionTests&quot;</span> <span class="Symbol">$</span> <span class="VarId">map</span> <span class="VarId">testExtension</span> <span class="VarId">testData</span>
                 <span class="Symbol">++</span> <span class="VarId">otherTests</span></pre></div></div></div><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">
<span class="Function">testExtension</span> <span class="Symbol">::</span> <span class="ConId">ExtensionTest</span> <span class="Symbol">-&gt;</span> <span class="ConId">Test.Framework.Test</span>
<span class="Function">testExtension</span> <span class="Symbol">(</span><span class="ConId">ExtensionTest</span> <span class="VarId">nm</span> <span class="VarId">tr</span> <span class="VarId">sast</span> <span class="VarId">ts</span><span class="Symbol">)</span> <span class="Symbol">=</span>
  <span class="VarId">testCase</span> <span class="VarId">nm</span> <span class="Symbol">$</span> <span class="Keyword">do</span>
    <span class="Keyword">let</span> <span class="VarId">ts'</span> <span class="Symbol">=</span> <span class="VarId">resetAnnotations</span> <span class="VarId">ts</span>
        <span class="VarId">es'</span> <span class="Symbol">=</span> <span class="VarId">resetAnnotations</span> <span class="Symbol">$</span> <span class="VarId">tr</span> <span class="VarId">sast</span>
    <span class="VarId">when</span> <span class="Symbol">(</span><span class="VarId">ts'</span> <span class="Symbol">/=</span> <span class="VarId">es'</span><span class="Symbol">)</span> <span class="Symbol">$</span> <span class="VarId">putStrLn</span> <span class="Symbol">$</span> <span class="VarId">printSql</span> <span class="VarId">ts'</span> <span class="Symbol">++</span> <span class="String">&quot;\n----\n&quot;</span> <span class="Symbol">++</span> <span class="VarId">printSql</span> <span class="VarId">es'</span> <span class="Symbol">++</span> <span class="String">&quot;\n====\n&quot;</span>
                        <span class="Comment">-- ++ ppExpr ts' ++ &quot;\n----\n&quot; ++ ppExpr es'</span>
    <span class="VarId">assertEqual</span> <span class="String">&quot;&quot;</span> <span class="VarId">ts'</span> <span class="VarId">es'</span></pre></div></div></div><br
     /><br
     /><br
     /><div class="footer"
    >generated on 01/29/11 20:06:46, hssqlppp-0.3.0</div
    ></body
  ></html
>
