<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >AlternateInsert</title
    ><link href="../../../../../../main.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><div class="header"
    ><a href="../../../../../../index.txt.html"
      >HsSqlPpp-0.3.0</a
      ></div
    ><br
     /><br
     /><br
     /><p
    >just an insert syntax a bit like updates, so the fields are next to the values</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode"><span class="Comment">{-# LANGUAGE QuasiQuotes, ScopedTypeVariables #-}</span>

<span class="Keyword">module</span> <span class="ConId">Database.HsSqlPpp.Examples.Extensions.AlternateInsert</span>
    <span class="Symbol">(</span><span class="VarId">altInsExamples</span>
    <span class="Symbol">,</span><span class="VarId">altIns</span><span class="Symbol">)</span> <span class="Keyword">where</span>

<span class="Keyword">import</span> <span class="ConId">Data.Generics</span>
<span class="Keyword">import</span> <span class="ConId">Data.Generics.Uniplate.Data</span>

<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Ast</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Annotation</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Examples.Extensions.ExtensionsUtils</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.SqlQuote</span>

<span class="Function">altInsExamples</span> <span class="Symbol">::</span> <span class="Symbol">[</span><span class="ConId">ExtensionTest</span><span class="Symbol">]</span>
<span class="Function">altInsExamples</span> <span class="Symbol">=</span> <span class="Symbol">[</span><span class="VarId">altInsExample1</span><span class="Symbol">]</span>

<span class="Function">altInsExample1</span> <span class="Symbol">::</span> <span class="ConId">ExtensionTest</span>
<span class="Function">altInsExample1</span> <span class="Symbol">=</span>
  <span class="ConId">ExtensionTest</span>
    <span class="String">&quot;tableValueExample1&quot;</span>
    <span class="VarId">altIns</span>
    <span class="Symbol">[$</span><span class="VarId">sqlStmts</span><span class="Symbol">|</span>
     <span class="VarId">select</span> <span class="VarId">table_insert</span><span class="Symbol">(</span><span class="VarId">spells_mr</span><span class="Symbol">,</span> <span class="Symbol">$$</span>
     <span class="Symbol">(</span><span class="VarId">spell_name</span> <span class="Symbol">=</span> '<span class="VarId">dark_citadel'</span>
     <span class="Symbol">,</span><span class="VarId">base_chance</span> <span class="Symbol">=</span> <span class="Number">50</span>
     <span class="Symbol">,</span><span class="VarId">alignment</span> <span class="Symbol">=</span> <span class="Symbol">-</span><span class="Number">1</span>
     <span class="Symbol">,</span><span class="VarId">spell_category</span> <span class="Symbol">=</span> '<span class="VarId">object'</span>
     <span class="Symbol">,</span><span class="VarId">description</span> <span class="Symbol">=</span> '<span class="ConId">Gives</span> <span class="VarId">wizard</span> <span class="VarId">building</span> <span class="VarId">to</span> <span class="VarId">hide</span> <span class="Keyword">in</span><span class="Symbol">.</span>'
     <span class="Symbol">,</span><span class="VarId">range</span> <span class="Symbol">=</span><span class="Number">8</span>
     <span class="Symbol">,</span><span class="VarId">num</span> <span class="Symbol">=</span> <span class="Number">1</span>
     <span class="Symbol">,</span><span class="VarId">valid_square_category</span> <span class="Symbol">=</span> <span class="VarId">empty</span>
     <span class="Symbol">,</span><span class="VarId">ptype</span> <span class="Symbol">=</span> <span class="VarId">dark_citadel</span><span class="Symbol">)</span>
    <span class="Symbol">,(</span><span class="VarId">spell_name</span><span class="Symbol">=</span> '<span class="VarId">dark_power'</span>
     <span class="Symbol">,</span><span class="VarId">base_chance</span> <span class="Symbol">=</span> <span class="Number">50</span><span class="Symbol">)</span>
      <span class="Symbol">$$);</span>
     <span class="Symbol">|]</span>
    <span class="Symbol">[$</span><span class="VarId">sqlStmts</span><span class="Symbol">|</span>
     <span class="VarId">insert</span> <span class="VarId">into</span> <span class="VarId">spells_mr</span><span class="Symbol">(</span><span class="VarId">spell_name</span>
                          <span class="Symbol">,</span><span class="VarId">base_chance</span>
                          <span class="Symbol">,</span><span class="VarId">alignment</span>
                          <span class="Symbol">,</span><span class="VarId">spell_category</span>
                          <span class="Symbol">,</span><span class="VarId">description</span>
                          <span class="Symbol">,</span><span class="VarId">range</span>
                          <span class="Symbol">,</span><span class="VarId">num</span>
                          <span class="Symbol">,</span><span class="VarId">valid_square_category</span>
                          <span class="Symbol">,</span><span class="VarId">ptype</span><span class="Symbol">)</span>
                  <span class="VarId">values</span> <span class="Symbol">(</span>'<span class="VarId">dark_citadel'</span>
                         <span class="Symbol">,</span><span class="Number">50</span>
                         <span class="Symbol">,-</span><span class="Number">1</span>
                         <span class="Symbol">,</span>'<span class="VarId">object'</span>
                         <span class="Symbol">,</span>'<span class="ConId">Gives</span> <span class="VarId">wizard</span> <span class="VarId">building</span> <span class="VarId">to</span> <span class="VarId">hide</span> <span class="Keyword">in</span><span class="Symbol">.</span>'
                         <span class="Symbol">,</span><span class="Number">8</span>
                         <span class="Symbol">,</span><span class="Number">1</span>
                         <span class="Symbol">,</span><span class="VarId">empty</span>
                         <span class="Symbol">,</span><span class="VarId">dark_citadel</span><span class="Symbol">);</span>
     <span class="VarId">insert</span> <span class="VarId">into</span> <span class="VarId">spells_mr</span><span class="Symbol">(</span><span class="VarId">spell_name</span>
                          <span class="Symbol">,</span><span class="VarId">base_chance</span><span class="Symbol">)</span>
                  <span class="VarId">values</span> <span class="Symbol">(</span>'<span class="VarId">dark_power'</span>
                         <span class="Symbol">,</span><span class="Number">50</span><span class="Symbol">);</span>
     <span class="Symbol">|]</span></pre></div></div></div><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode"><span class="Function">altIns</span> <span class="Symbol">::</span> <span class="ConId">Data</span> <span class="VarId">a</span> <span class="Symbol">=&gt;</span> <span class="VarId">a</span> <span class="Symbol">-&gt;</span> <span class="VarId">a</span>
<span class="Function">altIns</span> <span class="Symbol">=</span>
    <span class="VarId">transformBi</span> <span class="Symbol">$</span> <span class="Symbol">\</span><span class="VarId">x</span> <span class="Symbol">-&gt;</span>
      <span class="Keyword">case</span> <span class="VarId">x</span> <span class="Keyword">of</span>
        <span class="Symbol">[$</span><span class="VarId">sqlStmt</span><span class="Symbol">|</span> <span class="VarId">select</span> <span class="VarId">create_var</span><span class="Symbol">($</span><span class="VarId">s</span><span class="Symbol">(</span><span class="VarId">varname</span><span class="Symbol">),</span> <span class="Symbol">$</span><span class="VarId">s</span><span class="Symbol">(</span><span class="VarId">typename</span><span class="Symbol">));</span> <span class="Symbol">|]</span>
            <span class="Symbol">-&gt;</span> <span class="Keyword">let</span> <span class="VarId">tablename</span> <span class="Symbol">=</span> <span class="VarId">varname</span> <span class="Symbol">++</span> <span class="String">&quot;_table&quot;</span>
               <span class="Keyword">in</span> <span class="Symbol">[$</span><span class="VarId">sqlStmt</span><span class="Symbol">|</span>

  <span class="VarId">create</span> <span class="VarId">table</span> <span class="Symbol">$(</span><span class="VarId">tablename</span><span class="Symbol">)</span> <span class="Symbol">(</span>
   <span class="Symbol">$(</span><span class="VarId">varname</span><span class="Symbol">)</span> <span class="Symbol">$(</span><span class="VarId">typename</span><span class="Symbol">)</span>
  <span class="Symbol">);</span>

                   <span class="Symbol">|]</span>
        <span class="VarId">x1</span> <span class="Symbol">-&gt;</span> <span class="VarId">x1</span>
</pre></div></div></div><p
    >see the copy statements in the chaos sql - ugly, unreadable and uneditable - this is the motivation copy spell_sprites(spell_name, sprite) from stdin; magic_wood magic_tree shadow_wood shadow_tree magic_fire magic_fire</p
    ><p
    >copy spell_keys (spell_name, key) from stdin; magic_knife 1 magic_shield 2</p
    ><p
    >copy sprites (sprite,animation_speed) from stdin; bat 8 dead_bat 250 bear 23 dead_bear 250</p
    ><p
    >copy history_sounds (history_name,sound_name) from stdin; walked walk fly fly attack attack</p
    ><p
    >copy history_no_visuals (history_name) from stdin; wizard_up new_turn new_game</p
    ><p
    >copy colours (name,red,green,blue) from stdin; grid 32767 32767 32767 background 0 0 32767 black 0 0 0 blue 0 0 65535 green 0 65535 0 red 65535 0 0 pink 65535 49407 49407 purple 65535 0 65535 cyan 0 65535 65535 yellow 65535 65535 0 orange 65535 41215 0 grey 32767 32767 32767 white 65535 65535 65535 .</p
    ><p
    >copy key_control_settings(key_code, action_name) from stdin; Up move_cursor_up KP_Up move_cursor_up Left move_cursor_left KP_Left move_cursor_left</p
    ><p
    >copy wizard_starting_positions (wizard_count, place, x, y) from stdin; 2 0 1 4 2 1 13 4 3 0 7 1 3 1 1 8 3 2 13 8</p
    ><p
    >copy piece_prototypes_mr(ptype,flying,speed,agility,undead,ridable, ranged_weapon_type,ranged_attack_strength,range,attack_strength, physical_defense,magic_defense) from stdin; bat t 5 4 f f    1 1 9 bear f 2 2 f f    6 7 6 centaur f 4 5 f t projectile 2 4 1 3 5 crocodile f 1 2 f f    5 6 2 dark_citadel            dire_wolf f 3 2 f f    3 2 7 eagle t 6 2 f f    3 3 8 elf f 1 7 f f projectile 2 6 1 2 5 faun f 1 8 f f    3 2 7 ghost t 2 6 t f    1 3 9 giant f 2 5 f f    9 7 6 giant_rat f 3 2 f f    1 1 8 goblin f 1 4 f f    2 4 4 golden_dragon t 3 5 f f fire 5 4 9 9 5 gooey_blob          1  gorilla f 1 2 f f    6 5 4 green_dragon t 3 4 f f fire 4 6 5 8 4 gryphon t 5 6 f t    3 5 5 harpy t 5 5 f f    4 2 8 horse f 4 1 f t    1 3 8 hydra f 1 6 f f    7 8 4 king_cobra f 1 1 f f    4 1 6 lion f 4 3 f f    6 4 8 magic_castle            magic_fire            magic_tree          5  manticore t 5 8 f t projectile 1 3 3 6 6 ogre f 1 6 f f    4 7 3 orc f 1 4 f f    2 1 4 pegasus t 5 7 f t    2 4 6 red_dragon t 3 5 f f fire 3 5 7 9 4 shadow_tree         2 4  skeleton f 1 4 t f    3 2 3 spectre f 1 4 t f    4 2 6 unicorn f 4 7 f t    5 4 9 vampire t 4 5 t f    6 8 6 wall            wizard f 1 3      3 3 5 wraith f 2 5 t f    5 5 4 zombie f 1 3 t f    1 1 2 .</p
    ><p
    >copy spells_mr (spell_name, base_chance, alignment, spell_category, description, activate, target, range, num, ptype, valid_square_category) from stdin; dark_citadel 50 -1 object Gives wizard building to hide in.   8 1 dark_citadel empty dark_power 50 -2 attacking When cast on a wizard it kills all that wizards creations if successful. Allows 3 attacks on enemy creatures  t 20 3  creature_on_top decree 90 1 attacking When cast on a wizard it kills all that wizards creations if successful. Allows 1 attack on an enemy creature.  t 20 1  creature_on_top disbelieve 100 0 miscellaneous Allows illusion creatures to be destroyed. This spell has 100% casting chance, and is always available.  t 20 1  monster_on_top eagle 70 1 monster monster   1 1 eagle empty_or_corpse_only elf 70 2 monster monster   1 1 elf empty_or_corpse_only chaos 80 -2 miscellaneous Makes the world more chaos. t      faun 80 -1 monster monster   1 1 faun empty_or_corpse_only ghost 50 -1 monster monster   1 1 ghost empty_or_corpse_only giant 40 1 monster monster   1 1 giant empty_or_corpse_only giant_rat 100 0 monster monster   1 1 giant_rat empty_or_corpse_only goblin 100 -1 monster monster   1 1 goblin empty_or_corpse_only golden_dragon 10 2 monster monster   1 1 golden_dragon empty_or_corpse_only law 80 2 miscellaneous Makes the world more law. t      gooey_blob 100 -1 object Attacks enemy units it covers and randomly spreads across the map. Any unit covered up by a gooey blob will be able to carry on once it is uncovered (except wizards who are killed by gooey blobs).   6 1 gooey_blob empty_or_corpse_only gorilla 70 0 monster monster   1 1 gorilla empty_or_corpse_only green_dragon 10 -1 monster monster   1 1 green_dragon empty_or_corpse_only gryphon 60 1 monster monster   1 1 gryphon empty_or_corpse_only harpy 60 -1 monster monster   1 1 harpy empty_or_corpse_only horse 90 1 monster monster   1 1 horse empty_or_corpse_only hydra 50 -1 monster monster   1 1 hydra empty_or_corpse_only justice 50 2 attacking When cast on a wizard it kills all that wizards creations if successful. Allows 3 attacks.  t 20 3  creature_on_top king_cobra 90 1 monster monster   1 1 king_cobra empty_or_corpse_only large_chaos 60 -4 miscellaneous Makes the world more chaos. t      large_law 60 4 miscellaneous Makes the world more law. t      lightning 100 0 attacking Attacks creature it is cast at (more powerful than magic bolt)  t 4 1  attackable lion 60 1 monster monster   1 1 lion empty_or_corpse_only magic_armour 50 1 wizard Gives wizard increased protection from attack. t      magic_bolt 100 0 attacking Attacks creature it is cast at.  t 6 1  attackable magic_bow 50 1 wizard Gives wizard ranged weapon including undead creatures. t      magic_castle 50 1 object Gives wizard building to hide in.   8 1 magic_castle empty magic_fire 80 -1 object Attacks and kills enemy units it covers and randomly spreads across the map.   6 1 magic_fire empty magic_knife 70 1 wizard Gives wizard increase attack power including undead creatures. t      magic_shield 70 1 wizard Gives wizard increased protection from attack. t      magic_sword 40 1 wizard Gives wizard increase attack power including undead creatures. t      magic_wings 60 0 wizard Gives wizard ability to fly. t      magic_wood 80 1 object Summons up to eight magic trees near your wizard. If you put your wizard in a magic tree and leave him there, he gets a new spell after a few turns.   8 8 magic_tree empty_and_not_adjacent_to_tree manticore 50 -1 monster monster   1 1 manticore empty_or_corpse_only ogre 70 -1 monster monster   1 1 ogre empty_or_corpse_only orc 100 -1 monster monster   1 1 orc empty_or_corpse_only pegasus 60 2 monster monster   1 1 pegasus empty_or_corpse_only raise_dead 60 -1 miscellaneous Allows reanimation of dead bodies left on screen. Any creatures raised from the dead become undead creatures, able to attack other undeads.  t 4 1  corpse_only red_dragon 10 -2 monster monster   1 1 red_dragon empty_or_corpse_only shadow_form 80 0 wizard Gives wizard increased protection and allows movement of 3 spaces per turn. Disappears if wizard attacks anything. t      shadow_wood 50 -1 object Allows you to place up to eight shadow trees near your wizard. No two trees can be adjacent, and line of sight is needed in placing. Shadow trees can attack anything in contact with them (except undead).   8 8 shadow_tree empty_and_not_adjacent_to_tree skeleton 70 -1 monster monster   1 1 skeleton empty_or_corpse_only spectre 60 -1 monster monster   1 1 spectre empty_or_corpse_only subversion 100 0 miscellaneous Realigns enemy creature to your side.  t 7 1  monster_on_top turmoil 100 -2 miscellaneous Randomly moves all objects onscreen to a different location. Only available from a magic tree. t      unicorn 70 2 monster monster   1 1 unicorn empty_or_corpse_only vampire 20 -2 monster monster   1 1 vampire empty_or_corpse_only vengeance 90 -1 attacking When cast on a wizard it kills all that wizards creations if successful. Allows 1 attack on an enemy creature.  t 20 1  creature_on_top wall 80 0 object Allows four wall blocks to be built near the wizard, which blocks creatures paths, but can be flown over.   8 4 wall empty wraith 50 -1 monster monster   1 1 wraith empty_or_corpse_only zombie 90 -1 monster monster   1 1 zombie empty_or_corpse_only .</p
    ><br
     /><br
     /><br
     /><div class="footer"
    >generated on 01/29/11 20:06:46, hssqlppp-0.3.0</div
    ></body
  ></html
>
