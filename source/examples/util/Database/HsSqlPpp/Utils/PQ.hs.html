<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >PQ</title
    ><link href="../../../../../../main.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><div class="header"
    ><a href="../../../../../../index.html"
      >HsSqlPpp-0.3.0</a
      ></div
    ><br
     /><br
     /><br
     /><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode"><span class="Comment">-- GENERATED by C-&gt;Haskell Compiler, version 0.16.2 Crystal Seed, 24 Jan 2009 (Haskell)</span>
<span class="Comment">-- Edit the ORIGNAL .chs file instead!</span>


</pre></div></div></div><p
    >{-# LINE 1 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">
</pre></div></div></div><p
    >{-</p
    ><p
    >simple wrapper around libpq, focused on supporting copy from stdin/ to stdout</p
    ><p
    >-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

</pre></div></div></div><p
    >{-# LANGUAGE ForeignFunctionInterface #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">
<span class="Keyword">module</span> <span class="ConId">Database.HsSqlPpp.Utils.PQ</span> <span class="Keyword">where</span>


<span class="Keyword">import</span> <span class="ConId">Foreign</span>
<span class="Keyword">import</span> <span class="ConId">Database.HsSqlPpp.Utils.C2HS</span>

<span class="Keyword">data</span> <span class="ConId">ConnStatusType</span> <span class="Symbol">=</span> <span class="ConId">CONNECTION_OK</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_BAD</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_STARTED</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_MADE</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_AWAITING_RESPONSE</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_AUTH_OK</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_SETENV</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_SSL_STARTUP</span>
                    <span class="Symbol">|</span> <span class="ConId">CONNECTION_NEEDED</span>
                    <span class="Keyword">deriving</span> <span class="Symbol">(</span><span class="ConId">Enum</span><span class="Symbol">,</span><span class="ConId">Eq</span><span class="Symbol">,</span><span class="ConId">Show</span><span class="Symbol">)</span>

</pre></div></div></div><p
    >{-# LINE 22 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">
<span class="Keyword">data</span> <span class="ConId">ExecStatusType</span> <span class="Symbol">=</span> <span class="ConId">PGRES_EMPTY_QUERY</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_COMMAND_OK</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_TUPLES_OK</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_COPY_OUT</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_COPY_IN</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_BAD_RESPONSE</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_NONFATAL_ERROR</span>
                    <span class="Symbol">|</span> <span class="ConId">PGRES_FATAL_ERROR</span>
                    <span class="Keyword">deriving</span> <span class="Symbol">(</span><span class="ConId">Eq</span><span class="Symbol">,</span><span class="ConId">Show</span><span class="Symbol">)</span>
<span class="Keyword">instance</span> <span class="ConId">Enum</span> <span class="ConId">ExecStatusType</span> <span class="Keyword">where</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_EMPTY_QUERY</span> <span class="Symbol">=</span> <span class="Number">0</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_COMMAND_OK</span> <span class="Symbol">=</span> <span class="Number">1</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_TUPLES_OK</span> <span class="Symbol">=</span> <span class="Number">2</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_COPY_OUT</span> <span class="Symbol">=</span> <span class="Number">3</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_COPY_IN</span> <span class="Symbol">=</span> <span class="Number">4</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_BAD_RESPONSE</span> <span class="Symbol">=</span> <span class="Number">5</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_NONFATAL_ERROR</span> <span class="Symbol">=</span> <span class="Number">6</span>
  <span class="VarId">fromEnum</span> <span class="ConId">PGRES_FATAL_ERROR</span> <span class="Symbol">=</span> <span class="Number">7</span>

  <span class="VarId">toEnum</span> <span class="Number">0</span> <span class="Symbol">=</span> <span class="ConId">PGRES_EMPTY_QUERY</span>
  <span class="VarId">toEnum</span> <span class="Number">1</span> <span class="Symbol">=</span> <span class="ConId">PGRES_COMMAND_OK</span>
  <span class="VarId">toEnum</span> <span class="Number">2</span> <span class="Symbol">=</span> <span class="ConId">PGRES_TUPLES_OK</span>
  <span class="VarId">toEnum</span> <span class="Number">3</span> <span class="Symbol">=</span> <span class="ConId">PGRES_COPY_OUT</span>
  <span class="VarId">toEnum</span> <span class="Number">4</span> <span class="Symbol">=</span> <span class="ConId">PGRES_COPY_IN</span>
  <span class="VarId">toEnum</span> <span class="Number">5</span> <span class="Symbol">=</span> <span class="ConId">PGRES_BAD_RESPONSE</span>
  <span class="VarId">toEnum</span> <span class="Number">6</span> <span class="Symbol">=</span> <span class="ConId">PGRES_NONFATAL_ERROR</span>
  <span class="VarId">toEnum</span> <span class="Number">7</span> <span class="Symbol">=</span> <span class="ConId">PGRES_FATAL_ERROR</span>
  <span class="VarId">toEnum</span> <span class="VarId">unmatched</span> <span class="Symbol">=</span> <span class="VarId">error</span> <span class="Symbol">(</span><span class="String">&quot;ExecStatusType.toEnum: Cannot match &quot;</span> <span class="Symbol">++</span> <span class="VarId">show</span> <span class="VarId">unmatched</span><span class="Symbol">)</span>

</pre></div></div></div><p
    >{-# LINE 23 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Keyword">newtype</span> <span class="ConId">PGconn</span> <span class="Symbol">=</span> <span class="ConId">PGconn</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="Symbol">(</span><span class="ConId">PGconn</span><span class="Symbol">))</span>
</pre></div></div></div><p
    >{-# LINE 25 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Keyword">newtype</span> <span class="ConId">PGresult</span> <span class="Symbol">=</span> <span class="ConId">PGresult</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="Symbol">(</span><span class="ConId">PGresult</span><span class="Symbol">))</span>
</pre></div></div></div><p
    >{-# LINE 27 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">makePGConn</span> <span class="Symbol">::</span> <span class="ConId">Ptr</span> <span class="Symbol">()</span> <span class="Symbol">-&gt;</span> <span class="ConId">PGconn</span>
<span class="Function">makePGConn</span> <span class="VarId">p</span> <span class="Symbol">=</span> <span class="ConId">PGconn</span> <span class="Symbol">(</span><span class="VarId">castPtr</span> <span class="VarId">p</span><span class="Symbol">)</span>

<span class="Function">pqConnectdb</span> <span class="Symbol">::</span> <span class="ConId">String</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">PGconn</span><span class="Symbol">)</span>
<span class="Function">pqConnectdb</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="VarId">withCString</span> <span class="VarId">a1</span> <span class="Symbol">$</span> <span class="Symbol">\</span><span class="VarId">a1'</span> <span class="Symbol">-&gt;</span> 
  <span class="VarId">pqConnectdb'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 33 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqFinish</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">()</span>
<span class="Function">pqFinish</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqFinish'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">return</span> <span class="Symbol">()</span>
</pre></div></div></div><p
    >{-# LINE 36 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqStatus</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">ConnStatusType</span><span class="Symbol">)</span>
<span class="Function">pqStatus</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqStatus'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">cToEnum</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 39 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqErrorMessage</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">String</span><span class="Symbol">)</span>
<span class="Function">pqErrorMessage</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqErrorMessage'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">peekCString</span> <span class="VarId">res</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res'</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 42 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqExec</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">String</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">PGresult</span><span class="Symbol">)</span>
<span class="Function">pqExec</span> <span class="VarId">a1</span> <span class="VarId">a2</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">withCString</span> <span class="VarId">a2</span> <span class="Symbol">$</span> <span class="Symbol">\</span><span class="VarId">a2'</span> <span class="Symbol">-&gt;</span> 
  <span class="VarId">pqExec'_</span> <span class="VarId">a1'</span> <span class="VarId">a2'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 47 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqClear</span> <span class="Symbol">::</span> <span class="ConId">PGresult</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">()</span>
<span class="Function">pqClear</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqClear'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">return</span> <span class="Symbol">()</span>
</pre></div></div></div><p
    >{-# LINE 50 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqResultStatus</span> <span class="Symbol">::</span> <span class="ConId">PGresult</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">ExecStatusType</span><span class="Symbol">)</span>
<span class="Function">pqResultStatus</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqResultStatus'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">cToEnum</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 53 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqResStatus</span> <span class="Symbol">::</span> <span class="ConId">ExecStatusType</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">String</span><span class="Symbol">)</span>
<span class="Function">pqResStatus</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">cFromEnum</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqResStatus'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">peekCString</span> <span class="VarId">res</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res'</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 56 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqResultErrorMessage</span> <span class="Symbol">::</span> <span class="ConId">PGresult</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">String</span><span class="Symbol">)</span>
<span class="Function">pqResultErrorMessage</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqResultErrorMessage'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">peekCString</span> <span class="VarId">res</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res'</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 59 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">


<span class="Function">pqPutCopyData</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">String</span> <span class="Symbol">-&gt;</span> <span class="ConId">Int</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Int</span><span class="Symbol">)</span>
<span class="Function">pqPutCopyData</span> <span class="VarId">a1</span> <span class="VarId">a2</span> <span class="VarId">a3</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">withCString</span> <span class="VarId">a2</span> <span class="Symbol">$</span> <span class="Symbol">\</span><span class="VarId">a2'</span> <span class="Symbol">-&gt;</span> 
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a3'</span> <span class="Symbol">=</span> <span class="VarId">cIntConv</span> <span class="VarId">a3</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqPutCopyData'_</span> <span class="VarId">a1'</span> <span class="VarId">a2'</span> <span class="VarId">a3'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">cIntConv</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 65 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqPutCopyEnd</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">Maybe</span> <span class="ConId">String</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Int</span><span class="Symbol">)</span>
<span class="Function">pqPutCopyEnd</span> <span class="VarId">a1</span> <span class="VarId">a2</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">withMCString</span> <span class="VarId">a2</span> <span class="Symbol">$</span> <span class="Symbol">\</span><span class="VarId">a2'</span> <span class="Symbol">-&gt;</span> 
  <span class="VarId">pqPutCopyEnd'_</span> <span class="VarId">a1'</span> <span class="VarId">a2'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">cIntConv</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 69 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">withMCString</span> <span class="Symbol">::</span> <span class="ConId">Maybe</span> <span class="ConId">String</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">CString</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="VarId">a</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="VarId">a</span>
<span class="Function">withMCString</span> <span class="VarId">m</span> <span class="VarId">f</span> <span class="Symbol">=</span> <span class="Keyword">do</span>
  <span class="Keyword">case</span> <span class="VarId">m</span> <span class="Keyword">of</span>
    <span class="ConId">Nothing</span> <span class="Symbol">-&gt;</span> <span class="VarId">f</span> <span class="VarId">nullPtr</span>
    <span class="ConId">Just</span> <span class="VarId">s</span> <span class="Symbol">-&gt;</span> <span class="VarId">withCString</span> <span class="VarId">s</span> <span class="VarId">f</span>

<span class="Function">pqGetCopyData</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">Ptr</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="ConId">Int</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Int</span><span class="Symbol">)</span>
<span class="Function">pqGetCopyData</span> <span class="VarId">a1</span> <span class="VarId">a2</span> <span class="VarId">a3</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a2'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a2</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a3'</span> <span class="Symbol">=</span> <span class="VarId">cIntConv</span> <span class="VarId">a3</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqGetCopyData'_</span> <span class="VarId">a1'</span> <span class="VarId">a2'</span> <span class="VarId">a3'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">cIntConv</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 80 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">pqGetResult</span> <span class="Symbol">::</span> <span class="ConId">PGconn</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Maybe</span> <span class="ConId">PGresult</span><span class="Symbol">)</span>
<span class="Function">pqGetResult</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqGetResult'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">res'</span> <span class="Symbol">=</span> <span class="VarId">mPGresult</span> <span class="VarId">res</span><span class="Symbol">}</span> <span class="Keyword">in</span>
  <span class="VarId">return</span> <span class="Symbol">(</span><span class="VarId">res'</span><span class="Symbol">)</span>
</pre></div></div></div><p
    >{-# LINE 83 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">

<span class="Function">mPGresult</span> <span class="Symbol">::</span> <span class="ConId">PGresult</span> <span class="Symbol">-&gt;</span> <span class="ConId">Maybe</span> <span class="ConId">PGresult</span>
<span class="Function">mPGresult</span> <span class="VarId">p</span><span class="Symbol">@(</span><span class="ConId">PGresult</span> <span class="VarId">x</span><span class="Symbol">)</span> <span class="Symbol">=</span> <span class="Keyword">if</span> <span class="VarId">x</span> <span class="Symbol">==</span> <span class="VarId">nullPtr</span>
                 <span class="Keyword">then</span> <span class="ConId">Nothing</span>
                 <span class="Keyword">else</span> <span class="ConId">Just</span> <span class="VarId">p</span>

<span class="Function">pqFreemem</span> <span class="Symbol">::</span> <span class="ConId">Ptr</span> <span class="Symbol">()</span> <span class="Symbol">-&gt;</span> <span class="ConId">IO</span> <span class="Symbol">()</span>
<span class="Function">pqFreemem</span> <span class="VarId">a1</span> <span class="Symbol">=</span>
  <span class="Keyword">let</span> <span class="Symbol">{</span><span class="VarId">a1'</span> <span class="Symbol">=</span> <span class="VarId">id</span> <span class="VarId">a1</span><span class="Symbol">}</span> <span class="Keyword">in</span> 
  <span class="VarId">pqFreemem'_</span> <span class="VarId">a1'</span> <span class="Symbol">&gt;&gt;=</span> <span class="Symbol">\</span><span class="VarId">res</span> <span class="Symbol">-&gt;</span>
  <span class="VarId">return</span> <span class="Symbol">()</span>
</pre></div></div></div><p
    >{-# LINE 91 &quot;PQ.chs&quot; #-}</p
    ><div class='sourceCode'><div class='literate'><div class='haskell'><pre class="sourceCode">


<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQconnectdb&quot;</span>
  <span class="VarId">pqConnectdb'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">PGconn</span><span class="Symbol">)))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQfinish&quot;</span>
  <span class="VarId">pqFinish'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">()))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQstatus&quot;</span>
  <span class="VarId">pqStatus'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="ConId">CInt</span><span class="Symbol">))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQerrorMessage&quot;</span>
  <span class="VarId">pqErrorMessage'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQexec&quot;</span>
  <span class="VarId">pqExec'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">((</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">PGresult</span><span class="Symbol">))))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQclear&quot;</span>
  <span class="VarId">pqClear'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGresult</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">()))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQresultStatus&quot;</span>
  <span class="VarId">pqResultStatus'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGresult</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="ConId">CInt</span><span class="Symbol">))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQresStatus&quot;</span>
  <span class="VarId">pqResStatus'_</span> <span class="Symbol">::</span> <span class="Symbol">(</span><span class="ConId">CInt</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQresultErrorMessage&quot;</span>
  <span class="VarId">pqResultErrorMessage'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGresult</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQputCopyData&quot;</span>
  <span class="VarId">pqPutCopyData'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">((</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">CInt</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="ConId">CInt</span><span class="Symbol">))))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQputCopyEnd&quot;</span>
  <span class="VarId">pqPutCopyEnd'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">((</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="ConId">CInt</span><span class="Symbol">)))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQgetCopyData&quot;</span>
  <span class="VarId">pqGetCopyData'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">((</span><span class="ConId">Ptr</span> <span class="Symbol">(</span><span class="ConId">Ptr</span> <span class="ConId">CChar</span><span class="Symbol">))</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">CInt</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="ConId">CInt</span><span class="Symbol">))))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQgetResult&quot;</span>
  <span class="VarId">pqGetResult'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">PGconn</span><span class="Symbol">)</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">(</span><span class="ConId">PGresult</span><span class="Symbol">)))</span>

<span class="Function">foreign</span> <span class="Keyword">import</span> <span class="VarId">ccall</span> <span class="VarId">unsafe</span> <span class="String">&quot;PQ.chs.h PQfreemem&quot;</span>
  <span class="VarId">pqFreemem'_</span> <span class="Symbol">::</span> <span class="Symbol">((</span><span class="ConId">Ptr</span> <span class="Symbol">())</span> <span class="Symbol">-&gt;</span> <span class="Symbol">(</span><span class="ConId">IO</span> <span class="Symbol">()))</span>
</pre></div></div></div><br
     /><br
     /><br
     /><div class="footer"
    >generated on 01/31/11 20:00:52, hssqlppp-0.3.0</div
    ></body
  ></html
>
