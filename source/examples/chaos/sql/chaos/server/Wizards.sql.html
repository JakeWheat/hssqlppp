<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >Wizards</title
    ><link href="../../../../../../main.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><div class="header"
    ><a href="../../../../../../index.txt.html"
      >HsSqlPpp-0.3.0</a
      ></div
    ><br
     /><br
     /><br
     /><p
    >/* wizards =======</p
    ><p
    >the wizards have a bunch of possible upgrades from spells, and each has a spell book. In a way, they also form part of a larger entity - the army, which is the wizard and all his pieces, there is a strictly 1-1 relationship between the wizards and the armies.</p
    ><p
    >*/</p
    ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">
select module('Chaos.Server.Wizards');

create table wizards (
  wizard_name text primary key,
  shadow_form boolean default false,
  magic_sword boolean default false,
  magic_knife boolean default false,
  magic_shield boolean default false,
  magic_wings boolean default false,
  magic_armour boolean default false,
  magic_bow boolean default false,
  computer_controlled boolean,
  original_place int, -- 0 &lt;= n &lt; num wizards
  expired boolean default false
);
select set_relvar_type('wizards', 'data');

</pre></div></div></div><p
    >/*</p
    ><p
    >not sure this is the best way to implement wizards dying, rather than deleting their entries. wouldn't need to make a decision like this with temporal database support.</p
    ><p
    >*/</p
    ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">

</pre></div></div></div><p
    >/<em
      >create view live_wizards as select</em
      >, row_number() over(order by original_place) - 1 as place from wizards where not expired; */</p
    ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">

</pre></div></div></div><p
    >/* == spell books Wizard 'wizard_name' is able to cast spell 'spell_name'. */</p
    ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">

create table spell_books (
  id serial unique,
  wizard_name text references wizards,
  spell_name text references spells_mr
);
select set_relvar_type('spell_books', 'data');

select create_assertion('no_spells_for_stiffs',
  $$ not exists(select 1 from spell_books
  natural inner join wizards where expired = true)$$);
</pre></div></div></div><br
     /><br
     /><br
     /><div class="footer"
    >generated on 01/29/11 20:06:46, hssqlppp-0.3.0</div
    ></body
  ></html
>
