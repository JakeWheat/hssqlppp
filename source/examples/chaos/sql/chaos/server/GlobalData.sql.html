<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >GlobalData</title
    ><link href="../../../../../../main.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><div class="header"
    ><a href="../../../../../../index.html"
      >HsSqlPpp-0.3.0</a
      ></div
    ><br
     /><br
     /><br
     /><p
    >/*</p
    ><p
    >Visibility notes - find somewhere to put these Players should not be able to see each others spells before the cast phase. This is difficult when they are all on the same computer, but should be easy when they are not.</p
    ><p
    >Imaginary attribute should only be visible to owning player, same notes as previous.</p
    ><div id="global-data"
    ><h1
      >global data</h1
      ><p
      >*/</p
      ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">
<span class="Keyword">select</span> <span class="VarId">module</span><span class="Symbol">(</span><span class="Char">'Chaos.Server.GlobalData'</span><span class="Symbol">);</span>
</pre></div></div></div><p
      >/*</p
      ><div id="board-size"
      ><h2
	>board size</h2
	><p
	>changing the board size from the default has never been tested...</p
	><p
	>*/</p
	><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">
<span class="Keyword">create</span> <span class="Keyword">table</span> <span class="VarId">board_size</span> <span class="Symbol">(</span>
  <span class="VarId">width</span> <span class="Type">int</span><span class="Symbol">,</span>
  <span class="VarId">height</span> <span class="Type">int</span><span class="Symbol">,</span>
  <span class="Keyword">unique</span> <span class="Symbol">(</span><span class="VarId">width</span><span class="Symbol">,</span> <span class="VarId">height</span><span class="Symbol">)</span>
<span class="Symbol">);</span>
<span class="Keyword">select</span> <span class="VarId">set_relvar_type</span><span class="Symbol">(</span><span class="Char">'board_size'</span><span class="Symbol">,</span> <span class="Char">'data'</span><span class="Symbol">);</span>
<span class="Keyword">select</span> <span class="VarId">restrict_cardinality</span><span class="Symbol">(</span><span class="Char">'board_size'</span><span class="Symbol">,</span> <span class="Number">1</span><span class="Symbol">);</span>


<span class="Comment">--update operator out param: board_size</span>
<span class="Keyword">create</span> <span class="Keyword">function</span> <span class="VarId">init_board_size</span><span class="Symbol">()</span> <span class="Keyword">returns</span> <span class="Type">void</span> <span class="Keyword">as</span> $$
<span class="VarId">begin</span>
  <span class="Comment">-- default board size</span>
  <span class="Keyword">insert</span> <span class="Keyword">into</span> <span class="VarId">board_size</span> <span class="Symbol">(</span><span class="VarId">width</span><span class="Symbol">,</span> <span class="VarId">height</span><span class="Symbol">)</span> <span class="Keyword">values</span> <span class="Symbol">(</span><span class="Number">15</span><span class="Symbol">,</span> <span class="Number">10</span><span class="Symbol">);</span>
<span class="Keyword">end</span><span class="Symbol">;</span>
$$ <span class="Keyword">language</span> <span class="VarId">plpgsql</span> <span class="Keyword">volatile</span><span class="Symbol">;</span>

</pre></div></div></div><p
	>/*</p
	></div
      ><div id="law-chaos-rating"
      ><h2
	>law/ chaos rating</h2
	><p
	>The world has a law/ chaos rating which can be chaos-N, neutral or law-N. It starts neutral. When the world is chaos, then chaos spells become easier to cast, and law spells harder, and vice versa. It becomes more chaos when chaos spells are cast, and more law when law spells are cast.</p
	><p
	>*/</p
	><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">

<span class="Keyword">create</span> <span class="Keyword">domain</span> <span class="VarId">alignment</span> <span class="Keyword">as</span> <span class="Type">text</span> <span class="Keyword">check</span> <span class="Symbol">(</span><span class="VarId">value</span> <span class="VarId">in</span> <span class="Symbol">(</span><span class="Char">'law'</span><span class="Symbol">,</span> <span class="Char">'neutral'</span><span class="Symbol">,</span> <span class="Char">'chaos'</span><span class="Symbol">));</span>

<span class="Comment">--if world alignment = 0, world is neutral, if -ve world is chaos by that amount</span>
<span class="Comment">--if +ve world is law by that amount</span>
<span class="Keyword">select</span> <span class="VarId">create_var</span><span class="Symbol">(</span><span class="Char">'world_alignment'</span><span class="Symbol">,</span> <span class="Char">'int'</span><span class="Symbol">);</span>
<span class="Keyword">select</span> <span class="VarId">set_relvar_type</span><span class="Symbol">(</span><span class="Char">'world_alignment_table'</span><span class="Symbol">,</span> <span class="Char">'data'</span><span class="Symbol">);</span>

<span class="Keyword">create</span> <span class="Keyword">function</span> <span class="VarId">init_world_alignment</span><span class="Symbol">()</span> <span class="Keyword">returns</span> <span class="Type">void</span> <span class="Keyword">as</span> $$
<span class="VarId">begin</span>
  <span class="Keyword">insert</span> <span class="Keyword">into</span> <span class="VarId">world_alignment_table</span> <span class="Keyword">values</span> <span class="Symbol">(</span><span class="Number">0</span><span class="Symbol">);</span>
<span class="Keyword">end</span><span class="Symbol">;</span>
$$ <span class="Keyword">language</span> <span class="VarId">plpgsql</span> <span class="Keyword">volatile</span><span class="Symbol">;</span>
</pre></div></div></div></div
      ></div
    ><br
     /><br
     /><br
     /><div class="footer"
    >generated on 01/31/11 20:00:52, hssqlppp-0.3.0</div
    ></body
  ></html
>
