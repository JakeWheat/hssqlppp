<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >WizardDisplayInfo</title
    ><link href="../../../../../../main.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><div class="header"
    ><a href="../../../../../../index.html"
      >HsSqlPpp-0.3.0</a
      ></div
    ><br
     /><br
     /><br
     /><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">
<span class="Keyword">select</span> <span class="VarId">module</span><span class="Symbol">(</span><span class="Char">'Chaos.Client.WizardDisplayInfo'</span><span class="Symbol">);</span>


<span class="Keyword">create</span> <span class="Keyword">table</span> <span class="VarId">colours</span> <span class="Symbol">(</span>
       <span class="VarId">name</span> <span class="Type">text</span> <span class="Keyword">primary</span> <span class="Keyword">key</span><span class="Symbol">,</span>
       <span class="VarId">red</span> <span class="Type">int</span><span class="Symbol">,</span>
       <span class="VarId">green</span> <span class="Type">int</span><span class="Symbol">,</span>
       <span class="VarId">blue</span> <span class="VarId">int</span>
<span class="Symbol">);</span>
<span class="Keyword">select</span> <span class="VarId">set_relvar_type</span><span class="Symbol">(</span><span class="Char">'colours'</span><span class="Symbol">,</span> <span class="Char">'readonly'</span><span class="Symbol">);</span>

<span class="Keyword">copy</span> <span class="VarId">colours</span> <span class="Symbol">(</span><span class="VarId">name</span><span class="Symbol">,</span><span class="VarId">red</span><span class="Symbol">,</span><span class="VarId">green</span><span class="Symbol">,</span><span class="VarId">blue</span><span class="Symbol">)</span> <span class="Keyword">from</span> <span class="Keyword">stdin</span><span class="Symbol">;</span>
<span class="VarId">grid</span>	<span class="Number">32767</span>	<span class="Number">32767</span>	<span class="Number">32767</span>
<span class="VarId">background</span>	<span class="Number">0</span>	<span class="Number">0</span>	<span class="Number">32767</span>
<span class="VarId">black</span>	<span class="Number">0</span>	<span class="Number">0</span>	<span class="Number">0</span>
<span class="VarId">blue</span>	<span class="Number">0</span>	<span class="Number">0</span>	<span class="Number">65535</span>
<span class="VarId">green</span>	<span class="Number">0</span>	<span class="Number">65535</span>	<span class="Number">0</span>
<span class="VarId">red</span>	<span class="Number">65535</span>	<span class="Number">0</span>	<span class="Number">0</span>
<span class="VarId">pink</span>	<span class="Number">65535</span>	<span class="Number">49407</span>	<span class="Number">49407</span>
<span class="VarId">purple</span>	<span class="Number">65535</span>	<span class="Number">0</span>	<span class="Number">65535</span>
<span class="VarId">cyan</span>	<span class="Number">0</span>	<span class="Number">65535</span>	<span class="Number">65535</span>
<span class="VarId">yellow</span>	<span class="Number">65535</span>	<span class="Number">65535</span>	<span class="Number">0</span>
<span class="VarId">orange</span>	<span class="Number">65535</span>	<span class="Number">41215</span>	<span class="Number">0</span>
<span class="VarId">grey</span>	<span class="Number">32767</span>	<span class="Number">32767</span>	<span class="Number">32767</span>
<span class="VarId">white</span>	<span class="Number">65535</span>	<span class="Number">65535</span>	<span class="Number">65535</span>
\<span class="Symbol">.</span>

</pre></div></div></div><p
    >/* == wizard display info</p
    ><p
    >This table associates a wizards name (= the allegiance) from the server with a colour for the wizard and his army and a wizard sprite for display purposes.</p
    ><p
    >The sprite in this table is what the wizard uses if he doesn't have any upgrades.</p
    ><p
    >Wizard named 'name' started with sprite default_sprite, his army is coloured 'colour'. */</p
    ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">

<span class="Keyword">create</span> <span class="Keyword">table</span> <span class="VarId">wizard_display_info</span> <span class="Symbol">(</span>
  <span class="VarId">wizard_name</span> <span class="Type">text</span> <span class="Keyword">unique</span> <span class="Keyword">references</span> <span class="VarId">wizards</span><span class="Symbol">,</span>
  <span class="VarId">default_sprite</span> <span class="Type">text</span> <span class="Keyword">unique</span> <span class="Keyword">references</span> <span class="VarId">sprites</span><span class="Symbol">,</span> <span class="Comment">-- and matches /wizard.* /</span>
  <span class="VarId">colour</span> <span class="Type">text</span> <span class="VarId">unique</span>
<span class="Symbol">);</span>
<span class="Keyword">select</span> <span class="VarId">set_relvar_type</span><span class="Symbol">(</span><span class="Char">'wizard_display_info'</span><span class="Symbol">,</span><span class="Char">'data'</span><span class="Symbol">);</span>

</pre></div></div></div><p
    >/<em
      >create table init_wizard_display_info_argument ( wizard_name text unique references wizards, sprite text unique references sprites, -- starts with wizard colour text unique --todo: make list of colours ); select set_relvar_type('init_wizard_display_info_argument', 'stack');</em
      >/</p
    ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">

<span class="Keyword">create</span> <span class="Keyword">function</span> <span class="VarId">init_wizard_display_info</span><span class="Symbol">(</span><span class="VarId">a</span> <span class="VarId">wizard_display_info</span><span class="Symbol">[])</span> <span class="Keyword">returns</span> <span class="Type">void</span> <span class="Keyword">as</span> $$
<span class="VarId">begin</span>
    <span class="Keyword">insert</span> <span class="Keyword">into</span> <span class="VarId">wizard_display_info</span> <span class="Symbol">(</span><span class="VarId">wizard_name</span><span class="Symbol">,</span> <span class="VarId">default_sprite</span><span class="Symbol">,</span>  <span class="VarId">colour</span><span class="Symbol">)</span>
       <span class="Keyword">select</span> <span class="VarId">wizard_name</span><span class="Symbol">,</span><span class="VarId">default_sprite</span><span class="Symbol">,</span><span class="VarId">colour</span>
       <span class="Keyword">from</span> <span class="VarId">unnest</span><span class="Symbol">(</span><span class="VarId">a</span><span class="Symbol">);</span>
<span class="Keyword">end</span><span class="Symbol">;</span>
$$ <span class="Keyword">language</span> <span class="VarId">plpgsql</span> <span class="Keyword">volatile</span><span class="Symbol">;</span>

</pre></div></div></div><div id="section"
    ><h1
      >/*</h1
      ><p
      >== action history with colours</p
      ><p
      >create a view to supply grey as colour for corpses (corpses don't have an allegiance)</p
      ><p
      >*/</p
      ><div class='sourceCode'><div class='literate'><div class='sql'><pre class="sourceCode">
<span class="Keyword">create</span> <span class="Keyword">view</span> <span class="VarId">allegiance_colours</span> <span class="VarId">as</span>
  <span class="Keyword">select</span> <span class="VarId">wizard_name</span> <span class="Keyword">as</span> <span class="VarId">allegiance</span><span class="Symbol">,</span> <span class="VarId">colour</span> <span class="Keyword">from</span> <span class="VarId">wizard_display_info</span> <span class="Keyword">union</span> <span class="VarId">all</span>
  <span class="Keyword">select</span> <span class="Char">'dead'</span> <span class="Keyword">as</span> <span class="VarId">allegiance</span><span class="Symbol">,</span> <span class="Char">'grey'</span> <span class="Keyword">as</span> <span class="VarId">colour</span><span class="Symbol">;</span>

<span class="Keyword">create</span> <span class="Keyword">view</span> <span class="VarId">action_history_colour_mr</span> <span class="VarId">as</span>
<span class="Keyword">select</span> <span class="VarId">a</span><span class="Symbol">.*,</span> <span class="VarId">colour</span>
  <span class="Keyword">from</span> <span class="VarId">action_history_mr</span> <span class="VarId">a</span>
  <span class="Keyword">natural</span> <span class="Keyword">inner</span> <span class="Keyword">join</span> <span class="VarId">allegiance_colours</span><span class="Symbol">;</span>
</pre></div></div></div></div
    ><br
     /><br
     /><br
     /><div class="footer"
    >generated on 01/31/11 20:00:52, hssqlppp-0.3.0</div
    ></body
  ></html
>
