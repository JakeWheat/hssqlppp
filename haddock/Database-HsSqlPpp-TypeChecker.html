<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Database.HsSqlPpp.TypeChecker</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Database-HsSqlPpp-TypeChecker.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">hssqlppp-0.3.1: SQL parser and type checker</p></div><div id="content"><div id="module-header"><p class="caption">Database.HsSqlPpp.TypeChecker</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">typechecking/ annotation functions
</a></li><li><a href="#g:2">Annotated tree utils
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Contains the data types and functions for annotating
   an ast and working with annotated trees, including the
   representations of SQL data types.
</p><p>Annotations:
</p><ul><li> are attached to most of the ast node data types, but not quite all of them;
</li><li> types annotations are attached to most nodes during type checking;
</li><li> type errors are attached to the lowest down node that the type
    error is detected at;
</li><li> nodes who fail the type check or whose type depends on a node with
    a type error are given the type <code>TypeCheckFailed</code>;
</li><li> each statement has an additional <code>StatementInfo</code> annotation attached to it;
</li><li> the parser fills in the source position annotation in every
    annotatable ast node.
</li></ul></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:typeCheckStatements">typeCheckStatements</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>] -&gt; (<a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a>, [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>])</li><li class="src short"><a href="#v:typeCheckParameterizedStatement">typeCheckParameterizedStatement</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a> -&gt; Either String <a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a></li><li class="src short"><a href="#v:typeCheckQueryExpr">typeCheckQueryExpr</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a></li><li class="src short"><a href="#v:typeCheckScalarExpr">typeCheckScalarExpr</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a></li><li class="src short"><a href="#v:fixUpIdentifiers">fixUpIdentifiers</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>] -&gt; [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>]</li><li class="src short"><a href="#v:fixUpIdentifiersQE">fixUpIdentifiersQE</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a></li><li class="src short"><a href="#v:fixUpIdentifiersSE">fixUpIdentifiersSE</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a></li><li class="src short"><a href="#v:addExplicitCasts">addExplicitCasts</a> :: Data a =&gt; a -&gt; a</li><li class="src short"><a href="#v:canonicalizeTypeNames">canonicalizeTypeNames</a> :: Data a =&gt; a -&gt; a</li><li class="src short"><a href="#v:getStatementAnnotations">getStatementAnnotations</a> :: Data a =&gt; a -&gt; [<a href="Database-HsSqlPpp-Annotation.html#t:Annotation">Annotation</a>]</li></ul></div><div id="interface"><h1 id="g:1">typechecking/ annotation functions
</h1><div class="top"><p class="src"><a name="v:typeCheckStatements" class="def">typeCheckStatements</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>] -&gt; (<a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a>, [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>])</p><div class="doc"><p>Takes an ast, checks against catalog passed, and adds
   annotations, including types, type errors, and statement info.
   Returns the updated catalog as well as the annotated ast.
</p></div></div><div class="top"><p class="src"><a name="v:typeCheckParameterizedStatement" class="def">typeCheckParameterizedStatement</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a> -&gt; Either String <a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a></p><div class="doc"><p>Unfinished version of type check which can type check an
 individual statement with ? or positional arg placeholders in
 it. Will error if the statement isn't select, update, insert or
 delete. For use in type checking embedded parameterized
 statements. Does all typechecking and annotation that the regular
 typecheck does.
</p></div></div><div class="top"><p class="src"><a name="v:typeCheckQueryExpr" class="def">typeCheckQueryExpr</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a></p></div><div class="top"><p class="src"><a name="v:typeCheckScalarExpr" class="def">typeCheckScalarExpr</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a></p><div class="doc"><p>Testing utility, mainly used to check an expression for type errors
 or to get its type.
</p></div></div><div class="top"><p class="src"><a name="v:fixUpIdentifiers" class="def">fixUpIdentifiers</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>] -&gt; [<a href="Database-HsSqlPpp-Ast.html#t:Statement">Statement</a>]</p><div class="doc"><p>transform the tree by converting * to explicit lists of columns and adding qualifiers to all column references
</p></div></div><div class="top"><p class="src"><a name="v:fixUpIdentifiersQE" class="def">fixUpIdentifiersQE</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:QueryExpr">QueryExpr</a></p></div><div class="top"><p class="src"><a name="v:fixUpIdentifiersSE" class="def">fixUpIdentifiersSE</a> :: <a href="Database-HsSqlPpp-Catalog.html#t:Catalog">Catalog</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a> -&gt; <a href="Database-HsSqlPpp-Ast.html#t:ScalarExpr">ScalarExpr</a></p></div><div class="top"><p class="src"><a name="v:addExplicitCasts" class="def">addExplicitCasts</a> :: Data a =&gt; a -&gt; a</p><div class="doc"><p>Run through a typechecked tree and add in explicit casts where
 implicit casts are used to typecheck. Does function and operator
 calls, case result expressions, and string, integer and float
 literals at the moment, todo: union, array, greatest, least
</p></div></div><div class="top"><p class="src"><a name="v:canonicalizeTypeNames" class="def">canonicalizeTypeNames</a> :: Data a =&gt; a -&gt; a</p><div class="doc"><p>Convert all the typenames in the ast to canonical form
 e.g. int -&gt; int4
</p></div></div><h1 id="g:2">Annotated tree utils
</h1><div class="top"><p class="src"><a name="v:getStatementAnnotations" class="def">getStatementAnnotations</a> :: Data a =&gt; a -&gt; [<a href="Database-HsSqlPpp-Annotation.html#t:Annotation">Annotation</a>]</p><div class="doc"><p>Run through the ast and return all the annotations attached to
   a Statement node.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.9.2</p></div></body></html>